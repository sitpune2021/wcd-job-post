import{u as P,r as s,z as k,j as t,B as z,E as C}from"./index-BLGg1PeM.js";import{D as w}from"./DataTable-DRSkMcs8.js";import{P as E}from"./PageHeader-J8lhBylo.js";import{g as F}from"./applicant.service-DpFajeav.js";import{g as T}from"./master.service-nwUmKMmO.js";import{a as I}from"./date-za-3UH_q.js";import"./useDebounce-BtpJfvXE.js";import"./triangle-alert-DyHRPMb-.js";import"./plus-BNh4oGty.js";const K=()=>{const d=P(),[x,h]=s.useState([]),[g,p]=s.useState(!0),[m,f]=s.useState(""),[l,r]=s.useState(1),[c,j]=s.useState(10),[v,y]=s.useState(1),[_,N]=s.useState(0),[b,S]=s.useState([]),[o,D]=s.useState("");s.useEffect(()=>{(async()=>{try{const e=await T({is_active:!0});S(Array.isArray(e)?e:e.districts||[])}catch(e){console.error("Failed to load districts",e)}})()},[]);const u=s.useCallback(async()=>{p(!0);try{const e=await F({page:l,limit:c,search:m,district_id:o||void 0}),n=e?.data?.data?.applicants||e?.applicants||[],i=e?.data?.pagination||e?.pagination||{};h(n),y(i.totalPages||1),N(i.total??i.totalItems??0)}catch(a){console.error("Failed to fetch applicants",a),k.error(a.message||"Failed to load applicants")}finally{p(!1)}},[l,c,m,o]);s.useEffect(()=>{u()},[u]);const A=s.useMemo(()=>[{key:"applicant_no",header:"Applicant No",sortable:!0},{key:"full_name",header:"Name",sortable:!0,render:(a,e={})=>{const n=e.dob?new Date().getFullYear()-new Date(e.dob).getFullYear():null,i=Number.isFinite(e.profile_completion)?Math.min(100,Math.max(0,Math.round(e.profile_completion))):null;return t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-slate-900",children:e.full_name}),t.jsxs("div",{className:"text-xs text-slate-500 capitalize",children:[e.gender?`${e.gender}`:"",n&&e.gender?" â€¢ ":"",n?`${n} years`:""]}),i!==null&&t.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[t.jsx("div",{className:"h-1.5 w-24 bg-slate-200 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-blue-600",style:{width:`${i}%`}})}),t.jsxs("span",{className:"text-xs text-slate-600",children:[i,"% complete"]})]})]})}},{key:"contact",header:"Contact",render:(a,e={})=>t.jsxs("div",{children:[t.jsx("div",{className:"text-sm",children:e.mobile_no}),t.jsx("div",{className:"text-xs text-slate-500",children:e.email})]})},{key:"application_count",header:"Applications",className:"text-center",render:(a,e={})=>t.jsx("span",{className:"inline-flex items-center justify-center bg-blue-50 text-blue-700 px-2.5 py-0.5 rounded-full text-xs font-medium",children:e.application_count||0})},{key:"registration_date",header:"Registered On",sortable:!0,render:(a,e={})=>I(e.created_at,{includeTime:!1})},{key:"actions",header:"Actions",className:"text-center",render:(a,e={})=>t.jsx("div",{className:"flex justify-center",children:t.jsx(z,{variant:"ghost",size:"sm",onClick:()=>d(`/applicants/${e.applicant_id||e.user_id}`),children:t.jsx(C,{className:"h-4 w-4"})})})}],[d]);return t.jsxs("div",{className:"space-y-6",children:[t.jsx(E,{title:"Applicants",description:"View and manage registered applicants",children:t.jsx("div",{className:"w-64",children:t.jsxs("select",{className:"w-full rounded-md border-slate-300 text-sm focus:border-blue-500 focus:ring-blue-500",value:o,onChange:a=>{D(a.target.value),r(1)},children:[t.jsx("option",{value:"",children:"All Districts"}),b.map(a=>t.jsx("option",{value:a.district_id,children:a.district_name},a.district_id))]})})}),t.jsx(w,{columns:A,data:x,onSearch:f,pagination:{currentPage:l,totalPages:v,totalItems:_,onPageChange:r,pageSize:c,onPageSizeChange:a=>{j(a),r(1)},pageSizeOptions:[10,25,50,100]},isLoading:g,rowKey:"applicant_id",headerClassName:"bg-slate-900 text-white",showRowNumbers:!0})]})};export{K as default};
