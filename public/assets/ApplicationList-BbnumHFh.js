import{u as P,r as e,z as T,j as a,B as v,E as I}from"./index-BLGg1PeM.js";import{D as L}from"./DataTable-DRSkMcs8.js";import{g as k}from"./admin.service-VmgXE_XQ.js";import{f as w}from"./date-za-3UH_q.js";import{z as R,g as C,N as z}from"./master.service-nwUmKMmO.js";import"./useDebounce-BtpJfvXE.js";import"./triangle-alert-DyHRPMb-.js";const O={DRAFT:"bg-gray-100 text-gray-700",SUBMITTED:"bg-blue-100 text-blue-700",UNDER_REVIEW:"bg-yellow-100 text-yellow-700",ELIGIBLE:"bg-green-100 text-green-700",NOT_ELIGIBLE:"bg-red-100 text-red-700",ON_HOLD:"bg-amber-100 text-amber-700",DOCUMENT_PENDING:"bg-orange-100 text-orange-700",REJECTED:"bg-red-200 text-red-800",SELECTED:"bg-emerald-100 text-emerald-700",WAITLISTED:"bg-purple-100 text-purple-700"},X=()=>{const l=P(),[g,x]=e.useState([]),[h,c]=e.useState(!0),[p,y]=e.useState(""),[o,d]=e.useState(1),[n,_]=e.useState(10),[b,f]=e.useState(1),[S,E]=e.useState(0),[u,F]=e.useState({status:"",post_id:"",district_id:""}),[B,M]=e.useState(!1),[G,N]=e.useState([]),[U,A]=e.useState([]),[Q,D]=e.useState([]);e.useEffect(()=>{(async()=>{try{const[t,r,i]=await Promise.all([R({is_active:!0}),C({is_active:!0}),z({is_active:!0})]);N(Array.isArray(t)?t:t.posts||[]),A(Array.isArray(r)?r:r.districts||[]),D(Array.isArray(i)?i:i.statuses||[])}catch(t){console.error("Failed to load masters",t)}})()},[]);const m=e.useCallback(async()=>{c(!0);try{const s={page:o,limit:n,search:p,...Object.fromEntries(Object.entries(u).filter(([r,i])=>i!==""))},t=await k(s);x(t.applications||[]),f(t.pagination?.totalPages||1),E(t.pagination?.total??t.pagination?.totalItems??0)}catch(s){T.error(s.message||"Failed to load applications")}finally{c(!1)}},[o,n,p,u]);e.useEffect(()=>{m()},[m]);const j=e.useMemo(()=>[{key:"application_no",header:"Application No",sortable:!0},{key:"applicant",header:"Applicant",render:(s,t={})=>t.applicant?.personal?.full_name||t.applicant?.full_name||"-"},{key:"post",header:"Post",render:(s,t={})=>t.post?.post_name||"-"},{key:"post_district",header:"Post District",render:(s,t={})=>t.district?.district_name||"-"},{key:"personal_district",header:"Personal District",render:(s,t={})=>t.applicant?.address?.permanentDistrict?.district_name||"-"},{key:"status",header:"Status",className:"text-center",render:(s,t={})=>a.jsx("span",{className:`inline-flex rounded-full px-2 py-1 text-xs font-medium ${O[t.status]||"bg-gray-100"}`,children:t.status?.replace(/_/g," ")})},{key:"submitted_at",header:"Submitted",render:(s,t={})=>w(t.submitted_at)},{key:"actions",header:"Actions",className:"text-center",render:(s,t={})=>a.jsx("div",{className:"flex justify-center",children:a.jsx(v,{variant:"ghost",size:"sm",onClick:()=>t.application_id&&l(`/applications/${t.application_id}`),className:"text-blue-600 hover:text-blue-900",children:a.jsx(I,{className:"h-4 w-4"})})})}],[l]);return a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Applications"}),a.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Review and manage applications"})]})}),a.jsx(L,{columns:j,data:g,onSearch:y,pagination:{currentPage:o,totalPages:b,totalItems:S,onPageChange:d,pageSize:n,onPageSizeChange:s=>{_(s),d(1)},pageSizeOptions:[10,20,50]},isLoading:h,rowKey:"application_id",headerClassName:"bg-slate-900 text-white",showRowNumbers:!0})]})};export{X as default};
